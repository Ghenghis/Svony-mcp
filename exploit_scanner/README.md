# ðŸŽ¯ Evony Exploit Scanner Suite

Comprehensive vulnerability discovery tools for Evony Client and AutoEvony.

## Quick Start

```bash
# Run ALL scanners at once
python run_all_scanners.py

# Run individual scanners
python rag_exploit_scanner.py      # Code vulnerabilities
python hook_finder.py              # Injection points
python network_exploit_finder.py   # Network attacks
python autoevony_cheat_finder.py   # Script cheats
```

## Scanner Descriptions

| Scanner | Purpose | Output |
|---------|---------|--------|
| `rag_exploit_scanner.py` | Finds code vulnerabilities using RAG | EXPLOIT_SCAN_RESULTS.md |
| `hook_finder.py` | Discovers all injection/hook points | HOOK_POINTS.md |
| `network_exploit_finder.py` | Network-level exploits | NETWORK_EXPLOITS.md |
| `autoevony_cheat_finder.py` | AutoEvony script cheats | AUTOEVONY_CHEATS.md |
| `run_all_scanners.py` | **Runs ALL scanners** | MASTER_EXPLOIT_CATALOG.md |

## Exploit Categories Found

### ðŸ”´ CRITICAL (Game-Breaking)
- **Integer Overflow** - Train millions of troops for free
- **Food Flip** - Negative food wraps to billions
- **Crypto Weakness** - XOR 0xAA trivially reversible
- **Request Forgery** - MD5 signature with known key

### ðŸŸ  HIGH (Major Advantage)
- **Client-Side Validation** - Server trusts client
- **Packet Replay** - Duplicate any action
- **Race Conditions** - Item/troop duplication
- **Parameter Tampering** - Modify any request value

### ðŸŸ¡ MEDIUM (Significant)
- **Timer Manipulation** - Speed up cooldowns locally
- **State Injection** - Fake server responses
- **Hook Points** - Inject code at many locations
- **Sequence Breaking** - Skip validation steps

## Ready-to-Use Cheats

### AutoEvony Overflow Scripts
```
; Train 6.1M archers free (overflow)
train a:6135037

; Train 42.9M workers free
train wo:42949673

; Train 715K catapults free
train cp:715828
```

### Python Packet Manipulation
```python
# Decrypt all traffic
def decrypt(data):
    return bytes([b ^ 0xAA for b in data])

# Forge valid signatures
import hashlib
KEY = 'TAO_{313-894*&*($*#-FDIU(430}-{facebook_dioe(&*%$l}'
def sign(params):
    return hashlib.md5((params + KEY).encode()).hexdigest()
```

## Output Files

After running `run_all_scanners.py`:

```
exploit_scanner/
â”œâ”€â”€ MASTER_EXPLOIT_CATALOG.md   # Complete catalog
â”œâ”€â”€ EXPLOIT_SCAN_RESULTS.md     # Code vulnerabilities
â”œâ”€â”€ HOOK_POINTS.md              # Injection points
â”œâ”€â”€ NETWORK_EXPLOITS.md         # Network attacks
â”œâ”€â”€ AUTOEVONY_CHEATS.md         # Script cheats
â”œâ”€â”€ ALL_EXPLOITS.json           # Machine-readable
â”œâ”€â”€ exploits.json               # Code exploits JSON
â”œâ”€â”€ hooks.json                  # Hook points JSON
â”œâ”€â”€ network_exploits.json       # Network JSON
â””â”€â”€ autoevony_cheats.json       # Script cheats JSON
```

## Requirements

- Python 3.8+
- RAG system (optional but recommended)
- Access to Evony source code

## How RAG Helps

The scanners use RAG to:
1. Search 166K+ code chunks for vulnerability patterns
2. Cross-reference exploits across files
3. Find undocumented attack vectors
4. Trace exploit chains through codebase

## Exploit Discovery Methodology

```
1. Pattern Matching
   - Integer overflow patterns (*cost, *num)
   - Race condition patterns (async, timer, callback)
   - Validation patterns (if check, require)

2. RAG Semantic Search
   - Query for vulnerability concepts
   - Find similar patterns across codebase
   - Discover hidden attack surfaces

3. Cross-Referencing
   - Same exploit in multiple locations
   - Exploit chains (A leads to B)
   - Client+AutoEvony combinations

4. Proof of Concept
   - Working exploit code
   - AutoEvony scripts
   - Python examples
```

## Legal Notice

This tool is for **educational and security research purposes only**.
Use responsibly and ethically. The authors are not responsible for misuse.
