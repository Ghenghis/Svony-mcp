# ðŸŽ¯ EXPLOIT SCANNER RESULTS
**Scan Time:** 2026-01-05T06:44:47.487853
**Total Findings:** 11

## Summary by Category
- **integer_overflow**: 2 findings
- **validation_bypass**: 2 findings
- **crypto_weakness**: 2 findings
- **race_condition**: 1 findings
- **network_exploit**: 1 findings
- **timing_attack**: 1 findings
- **injection**: 1 findings
- **hook_point**: 1 findings

## Summary by Severity
- **CRITICAL**: 2
- **HIGH**: 6
- **MEDIUM**: 3
- **LOW**: 0

---

## ðŸ”´ CRITICAL Exploits

### Integer Overflow Troop Training
**Category:** integer_overflow
**Location:** `com/evony/client/action/TroopCommands.as`
**Detection Risk:** LOW - Server may not validate overflow

**Description:**
Training massive troops causes integer overflow, resulting in free/negative cost

**Code Pattern:**
```
num * cost > INT32_MAX
```

**Exploit Method:**

1. Calculate overflow threshold: INT32_MAX / troop_food_cost + 1
2. Train that exact number of troops
3. Cost wraps to negative, giving free troops or resources

Thresholds:
- Archer (350 food): 6,135,037 troops
- Worker (50 food): 42,949,673 troops  
- Catapult (3000 food): 715,828 troops


**Requirements:**
- Sufficient barracks capacity
- Population available

**Proof of Concept:**
```
train a:6135037
```

**Cross-References:**
- `food_flip`
- `resource_overflow`
- `com/evony/Context.as:timerHandler`

### Food Flip Glitch
**Category:** integer_overflow
**Location:** `com/evony/Context.as:timerHandler`
**Detection Risk:** MEDIUM - Abnormal resource values

**Description:**
Negative food consumption flips to massive positive

**Code Pattern:**
```
food.amount = base + (increaseRate - troopCostFood)
```

**Exploit Method:**

1. Build massive army to increase troopCostFood
2. Let food go negative (overflow)
3. Negative value wraps to INT32_MAX
4. Instant billions of food


**Requirements:**
- Large army
- Low food production

**Proof of Concept:**
```
Build 10M+ archers, wait for food tick
```

**Cross-References:**
- `troop_overflow`
- `resource_calc`
- `com/evony/client/action/TroopCommands.as`

## ðŸŸ  HIGH Severity Exploits

### Race Condition Item Duplication
**Category:** race_condition
**Location:** `com/evony/client/action/ItemCommands.as`
**Detection Risk:** MEDIUM - Rapid duplicate requests

**Description:**
Rapid item use before server confirms consumption

**Code Pattern:**
```
sendMessage before wait for response
```

**Exploit Method:**

1. Send item.useItem command
2. Immediately send again before response
3. Client allows both, server may process both
4. Item duplicated or effect stacked


**Requirements:**
- Fast connection
- Timing precision

**Proof of Concept:**
```
Rapid-fire useItem with same itemId
```

**Cross-References:**
- `packet_replay`
- `command_flood`

### Client-Side Validation Only
**Category:** validation_bypass
**Location:** `com/evony/SenderImpl.as`
**Detection Risk:** LOW - Server often trusts client

**Description:**
Many checks only exist on client, server trusts client

**Code Pattern:**
```
if (bVisitor || getCurCastle() == null) return
```

**Exploit Method:**

1. Intercept sendMessage calls
2. Bypass client-side checks
3. Send commands that client would block
4. Server may accept without validation

Bypassable checks:
- Visitor restrictions
- Resource requirements
- Cooldown timers
- Building requirements


**Requirements:**
- Packet interception tool
- Protocol knowledge

**Proof of Concept:**
```
Send upgrade command without resources
```

**Cross-References:**
- `packet_injection`
- `proxy_modify`
- `army.newArmy params`

### Negative Resource Transfer
**Category:** validation_bypass
**Location:** `army.newArmy params`
**Detection Risk:** MEDIUM - Unusual resource values

**Description:**
Sending negative resources in transport gives to sender

**Code Pattern:**
```
resource string not validated for negative
```

**Exploit Method:**

1. Create transport army
2. Set resource values as negative: "-1000000,-1000000,..."
3. Server may interpret as giving resources TO you
4. Drain target's resources


**Requirements:**
- Target coordinates
- Transport capability

**Proof of Concept:**
```
transport 100,200 r:-1000000,-1000000,0,0,0
```

**Cross-References:**
- `parameter_injection`
- `type_confusion`
- `com/evony/SenderImpl.as`

### Predictable Request Signature
**Category:** crypto_weakness
**Location:** `Request signing`
**Detection Risk:** NONE - Valid signatures

**Description:**
MD5 signature uses known static key

**Code Pattern:**
```
MD5(params + ACTION_KEY)
```

**Exploit Method:**

1. Know ACTION_KEY (extracted)
2. Construct any params string
3. Calculate MD5(params + ACTION_KEY)
4. Send with valid signature

ACTION_KEY: "TAO_{313-894*&*($*#-FDIU(430}-{facebook_dioe(&*%$l}"


**Requirements:**
- ACTION_KEY (known)

**Proof of Concept:**
```
hashlib.md5(params + ACTION_KEY).hexdigest()
```

**Cross-References:**
- `request_forge`
- `key_extraction`
- `Protocol encryption layer`

### Dynamic Object Injection
**Category:** injection
**Location:** `AMF deserialization`
**Detection Risk:** MEDIUM - Unusual properties

**Description:**
Dynamic AS3 objects allow property injection

**Code Pattern:**
```
obj[prop] = value with dynamic class
```

**Exploit Method:**

1. Craft AMF response with extra properties
2. Dynamic objects accept any property
3. Inject unexpected values
4. May override internal state

Targets:
- PlayerBean
- CastleBean
- TroopBean (add fake troops)


**Requirements:**
- AMF crafting capability
- MITM position

**Proof of Concept:**
```
Add 'gold.amount': 999999999 to response
```

**Cross-References:**
- `amf_craft`
- `response_inject`

### ExternalInterface Hook
**Category:** hook_point
**Location:** `ExternalInterface.call usage`
**Detection Risk:** LOW - Client-side only

**Description:**
Flash ExternalInterface allows JavaScript injection

**Code Pattern:**
```
ExternalInterface.addCallback
```

**Exploit Method:**

1. Load game in controlled browser
2. Override ExternalInterface callbacks
3. Intercept all Flash-JS communication
4. Modify data in transit

Hookable functions found in client.


**Requirements:**
- Browser control
- JavaScript access

**Proof of Concept:**
```
Override window.__flash__* functions
```

**Cross-References:**
- `js_bridge`
- `browser_hook`

## ðŸŸ¡ MEDIUM Severity Exploits

### Session Replay Attack
**Category:** network_exploit
**Location:** `Network layer`
**Detection Risk:** LOW - Identical packets common

**Description:**
Captured packets can be replayed

**Code Pattern:**
```
No nonce/timestamp validation
```

**Exploit Method:**

1. Capture successful command packet
2. Save packet bytes
3. Replay same packet later
4. Action repeats if server doesn't track

Best targets:
- Resource collection
- Item usage
- Troop training


**Requirements:**
- Packet capture tool
- Understanding of AMF

**Proof of Concept:**
```
Capture train command, replay 10x
```

**Cross-References:**
- `packet_capture`
- `amf_decode`

### Timer Manipulation
**Category:** timing_attack
**Location:** `com/evony/Context.as:timerHandler`
**Detection Risk:** LOW - Only affects display

**Description:**
Client-side timers can be manipulated

**Code Pattern:**
```
timer.start() with local time
```

**Exploit Method:**

1. Hook Flash timer functions
2. Accelerate timer callbacks
3. Client thinks more time passed
4. Cooldowns expire faster locally

Affects:
- Building queue display
- March time estimates
- Resource accumulation display


**Requirements:**
- Flash debugging tools
- Memory editing

**Proof of Concept:**
```
CheatEngine to speed up timer
```

**Cross-References:**
- `memory_edit`
- `client_hook`

### Weak XOR Encryption
**Category:** crypto_weakness
**Location:** `Protocol encryption layer`
**Detection Risk:** NONE - Just reading

**Description:**
XOR with single byte key is trivially reversible

**Code Pattern:**
```
data XOR 0xAA
```

**Exploit Method:**

1. Capture encrypted packet
2. XOR all bytes with 0xAA
3. Plaintext revealed
4. Modify and re-encrypt

Key: 0xAA (170 decimal)


**Requirements:**
- Packet capture

**Proof of Concept:**
```
bytes([b ^ 0xAA for b in packet])
```

**Cross-References:**
- `packet_decode`
- `crypto_keys`
- `Request signing`

## ðŸŸ¢ LOW Severity Exploits
